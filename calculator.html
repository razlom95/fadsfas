<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Premium Renovation Calculator</title>
    <style>
        /* --- CSS –ü–ï–†–ï–ú–ï–ù–ù–´–ï (–ì–õ–û–ë–ê–õ–¨–ù–´–ô –°–¢–ò–õ–¨) --- */
        :root {
            --accent-color: #6366f1; /* –ò–Ω–¥–∏–≥–æ */
            --accent-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            --glass-bg: rgba(255, 255, 255, 0.75);
            --glass-border: rgba(255, 255, 255, 0.6);
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --card-radius: 28px;
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* –°–±—Ä–æ—Å –∏ –±–∞–∑–∞ */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0; padding: 0;
            font-family: var(--font-family);
            background-color: #f1f5f9;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            perspective: 1200px; /* –ì–ª—É–±–∏–Ω–∞ –¥–ª—è 3D */
        }

        /* --- –ê–ù–ò–ú–ò–†–û–í–ê–ù–ù–´–ô –§–û–ù (BLOBS) --- */
        .ambient-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            overflow: hidden; background: #f8fafc;
        }
        .blob {
            position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6;
            animation: float 20s infinite ease-in-out;
        }
        .blob-1 { width: 400px; height: 400px; background: #c4b5fd; top: -100px; left: -100px; }
        .blob-2 { width: 350px; height: 350px; background: #93c5fd; bottom: -50px; right: -50px; animation-delay: -5s; }
        .blob-3 { width: 200px; height: 200px; background: #fca5a5; top: 40%; left: 30%; animation-delay: -10s; }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
        }

        /* --- 3D –ö–ê–†–¢–û–ß–ö–ê --- */
        .calc-wrapper {
            width: 100%; max-width: 480px; padding: 20px;
            transform-style: preserve-3d; /* –í–∞–∂–Ω–æ –¥–ª—è 3D */
            transition: transform 0.1s ease-out;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            border-radius: var(--card-radius);
            box-shadow: 
                0 20px 40px -10px rgba(0,0,0,0.1), 
                0 0 0 1px rgba(255,255,255,0.5) inset;
            overflow: hidden;
            display: flex; flex-direction: column;
            min-height: 550px;
            transform: translateZ(20px); /* –í—ã–¥–≤–∏–≥–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –≤–ø–µ—Ä–µ–¥ */
        }

        /* --- UI HEADER --- */
        .progress-container { padding: 30px 30px 10px 30px; }
        .progress-track {
            height: 6px; background: rgba(0,0,0,0.05); border-radius: 10px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; width: 0%; background: var(--accent-gradient);
            border-radius: 10px; transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.5);
        }

        /* --- –ö–û–ù–¢–ï–ù–¢ (–®–ê–ì–ò) --- */
        .step-content {
            padding: 20px 30px 30px 30px;
            flex-grow: 1; display: flex; flex-direction: column;
        }

        .step { display: none; flex-direction: column; height: 100%; }
        .step.active { display: flex; }

        h2 { font-size: 24px; font-weight: 800; color: var(--text-primary); margin: 0 0 10px 0; letter-spacing: -0.5px; }
        p.subtitle { color: var(--text-secondary); font-size: 15px; margin: 0 0 25px 0; line-height: 1.5; }

        /* --- –ö–ê–†–¢–û–ß–ö–ò –í–´–ë–û–†–ê (OPTIONS) --- */
        .options-grid { display: grid; gap: 12px; }

        .option-card {
            background: rgba(255,255,255,0.5);
            border: 2px solid transparent;
            padding: 16px; border-radius: 18px;
            cursor: pointer; position: relative;
            display: flex; align-items: center; gap: 15px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            transform: translateY(20px); opacity: 0; /* –î–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è */
            animation: slideUp 0.5s forwards;
        }
        /* –ó–∞–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –ª–µ—Å–µ–Ω–∫–∏ */
        .step.active .option-card:nth-child(1) { animation-delay: 0.1s; }
        .step.active .option-card:nth-child(2) { animation-delay: 0.2s; }
        .step.active .option-card:nth-child(3) { animation-delay: 0.3s; }

        @keyframes slideUp { to { transform: translateY(0); opacity: 1; } }

        .option-card:hover { background: #fff; transform: translateY(-3px) scale(1.02); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .option-card.selected { background: #fff; border-color: var(--accent-color); box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15); }

        .opt-icon {
            font-size: 24px; width: 44px; height: 44px;
            background: #fff; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .opt-text strong { display: block; color: var(--text-primary); margin-bottom: 3px; }
        .opt-text span { font-size: 13px; color: var(--text-secondary); }

        /* --- –°–õ–ê–ô–î–ï–† --- */
        .range-wrapper { text-align: center; margin: 40px 0; }
        .range-display {
            font-size: 56px; font-weight: 800;
            background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        input[type=range] {
            -webkit-appearance: none; width: 100%; background: transparent; margin-top: 20px;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 32px; width: 32px; border-radius: 50%;
            background: #fff; border: 4px solid var(--accent-color);
            cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2); margin-top: -12px;
            transition: transform 0.2s;
        }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 8px; background: #e2e8f0; border-radius: 4px;
        }

        /* --- CHECKBOX TOGGLES --- */
        .toggle-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 18px; background: rgba(255,255,255,0.6); border-radius: 16px; margin-bottom: 10px;
            transition: 0.2s;
        }
        .toggle-switch {
            width: 52px; height: 30px; background: #cbd5e1; border-radius: 30px;
            position: relative; transition: 0.3s; cursor: pointer;
        }
        .toggle-switch::after {
            content: ''; position: absolute; top: 3px; left: 3px; width: 24px; height: 24px;
            background: #fff; border-radius: 50%; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .toggle-item.active .toggle-switch { background: var(--accent-color); }
        .toggle-item.active .toggle-switch::after { transform: translateX(22px); }

        /* --- NAVIGATION --- */
        .nav-footer {
            margin-top: auto; display: flex; gap: 15px; padding-top: 20px;
        }
        .btn {
            border: none; padding: 16px 24px; border-radius: 14px;
            font-weight: 600; font-size: 16px; cursor: pointer; transition: 0.3s;
        }
        .btn-primary {
            background: var(--accent-gradient); color: #fff; width: 100%;
            box-shadow: 0 8px 20px -5px rgba(99, 102, 241, 0.4);
            position: relative; overflow: hidden;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 25px -5px rgba(99, 102, 241, 0.6); }
        .btn-back { background: transparent; color: var(--text-secondary); }
        .btn-back:hover { background: rgba(0,0,0,0.05); color: var(--text-primary); }

        /* --- RESULT SCREEN --- */
        .result-box {
            text-align: center; background: #fff; padding: 30px; border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.05); margin-bottom: 25px;
            animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .price-final {
            font-size: 42px; font-weight: 900;
            background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }
        
        .messenger-btn {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            width: 100%; padding: 16px; margin-bottom: 12px; border-radius: 14px;
            text-decoration: none; color: #fff; font-weight: 600;
            transition: transform 0.2s;
        }
        .messenger-btn:hover { transform: scale(1.02); }
        .bg-wa { background: linear-gradient(90deg, #25D366, #128C7E); box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4); }
        .bg-tg { background: linear-gradient(90deg, #229ED9, #0088cc); box-shadow: 0 4px 15px rgba(34, 158, 217, 0.4); }

    </style>
</head>
<body>

    <!-- –ñ–∏–≤–æ–π —Ñ–æ–Ω -->
    <div class="ambient-bg">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- 3D –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="calc-wrapper" id="tiltWrapper">
        <div class="glass-card">
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å -->
            <div class="progress-container">
                <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600; text-transform: uppercase;">
                    <span id="stepCounter">–®–∞–≥ 1 –∏–∑ 5</span>
                    <span id="percentCounter">0%</span>
                </div>
                <div class="progress-track">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

            <div class="step-content">
                
                <!-- STEP 1: –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ -->
                <div class="step active" id="step1">
                    <h2>–ß—Ç–æ –±—É–¥–µ–º —Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å?</h2>
                    <p class="subtitle">–û—Ç —Ç–∏–ø–∞ –¥–æ–º–∞ –∑–∞–≤–∏—Å–∏—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–µ—Ä–Ω–æ–≤—ã—Ö —Ä–∞–±–æ—Ç.</p>
                    <div class="options-grid">
                        <div class="option-card" onclick="selectOption('type', 'new', 1.0, this)">
                            <div class="opt-icon">üè¢</div>
                            <div class="opt-text"><strong>–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞</strong><span>–°–≤–æ–±–æ–¥–Ω–∞—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ / –ë–µ—Ç–æ–Ω</span></div>
                        </div>
                        <div class="option-card" onclick="selectOption('type', 'secondary', 1.3, this)">
                            <div class="opt-icon">üè†</div>
                            <div class="opt-text"><strong>–í—Ç–æ—Ä–∏—á–∫–∞</strong><span>–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–º–æ–Ω—Ç–∞–∂ —Å—Ç–∞—Ä–æ–≥–æ</span></div>
                        </div>
                        <div class="option-card" onclick="selectOption('type', 'house', 1.1, this)">
                            <div class="opt-icon">üè°</div>
                            <div class="opt-text"><strong>–ß–∞—Å—Ç–Ω—ã–π –¥–æ–º</strong><span>–ö–æ—Ç—Ç–µ–¥–∂ –∏–ª–∏ —Ç–∞—É–Ω—Ö–∞—É—Å</span></div>
                        </div>
                    </div>
                </div>

                <!-- STEP 2: –ü–ª–æ—â–∞–¥—å -->
                <div class="step" id="step2">
                    <h2>–ü–ª–æ—â–∞–¥—å –ø–æ–º–µ—â–µ–Ω–∏—è</h2>
                    <p class="subtitle">–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏–º–µ—Ä–Ω—ã–π –º–µ—Ç—Ä–∞–∂ –ø–æ –ø–æ–ª—É.</p>
                    
                    <div class="range-wrapper">
                        <div class="range-display"><span id="areaVal">55</span> <span style="font-size: 24px; color: #94a3b8;">–º¬≤</span></div>
                        <input type="range" min="20" max="200" value="55" step="1" oninput="updateArea(this.value)">
                    </div>
                    
                    <div class="nav-footer">
                        <button class="btn btn-back" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
                        <button class="btn btn-primary" onclick="nextStep()">–î–∞–ª–µ–µ</button>
                    </div>
                </div>

                <!-- STEP 3: –ö–æ–º–Ω–∞—Ç—ã -->
                <div class="step" id="step3">
                    <h2>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç</h2>
                    <div class="options-grid">
                        <div class="option-card" onclick="selectOption('rooms', '1', 0, this)">
                            <div class="opt-icon">1Ô∏è‚É£</div>
                            <div class="opt-text"><strong>–°—Ç—É–¥–∏—è / 1 –∫–æ–º–Ω–∞—Ç–∞</strong></div>
                        </div>
                        <div class="option-card" onclick="selectOption('rooms', '2', 0, this)">
                            <div class="opt-icon">2Ô∏è‚É£</div>
                            <div class="opt-text"><strong>2 –∫–æ–º–Ω–∞—Ç—ã</strong></div>
                        </div>
                        <div class="option-card" onclick="selectOption('rooms', '3', 0, this)">
                            <div class="opt-icon">3Ô∏è‚É£</div>
                            <div class="opt-text"><strong>3 –∫–æ–º–Ω–∞—Ç—ã –∏ –±–æ–ª–µ–µ</strong></div>
                        </div>
                    </div>
                    <div class="nav-footer">
                        <button class="btn btn-back" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>

                <!-- STEP 4: –°—Ç–∏–ª—å (–¶–µ–Ω–∞) -->
                <div class="step" id="step4">
                    <h2>–ö–ª–∞—Å—Å —Ä–µ–º–æ–Ω—Ç–∞</h2>
                    <div class="options-grid">
                        <div class="option-card" onclick="selectOption('level', 'base', 12000, this)">
                            <div class="opt-icon">üõ†</div>
                            <div class="opt-text"><strong>–ë–∞–∑–æ–≤—ã–π</strong><span>–ö–æ—Å–º–µ—Ç–∏–∫–∞, –Ω–µ–¥–æ—Ä–æ–≥–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</span></div>
                        </div>
                        <div class="option-card" onclick="selectOption('level', 'standard', 25000, this)">
                            <div class="opt-icon">‚ú®</div>
                            <div class="opt-text"><strong>–ö–æ–º—Ñ–æ—Ä—Ç</strong><span>–ö–∞–ø–∏—Ç–∞–ª—å–Ω—ã–π, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, –ø–ª–∏—Ç–∫–∞</span></div>
                        </div>
                        <div class="option-card" onclick="selectOption('level', 'premium', 45000, this)">
                            <div class="opt-icon">üíé</div>
                            <div class="opt-text"><strong>–ü—Ä–µ–º–∏—É–º</strong><span>–ü–æ –¥–∏–∑–∞–π–Ω-–ø—Ä–æ–µ–∫—Ç—É, –¥–æ—Ä–æ–≥–∏–µ –±—Ä–µ–Ω–¥—ã</span></div>
                        </div>
                    </div>
                    <div class="nav-footer">
                        <button class="btn btn-back" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>

                <!-- STEP 5: –û–ø—Ü–∏–∏ -->
                <div class="step" id="step5">
                    <h2>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</h2>
                    <p class="subtitle">–ß—Ç–æ –≤–∫–ª—é—á–∏—Ç—å –≤ —Ä–∞—Å—á–µ—Ç?</p>
                    
                    <div class="toggle-item" onclick="toggleAddon('design', 2500, this)">
                        <div class="opt-text"><strong>–î–∏–∑–∞–π–Ω-–ø—Ä–æ–µ–∫—Ç</strong><span>–ß–µ—Ä—Ç–µ–∂–∏ + –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è 3D</span></div>
                        <div class="toggle-switch"></div>
                    </div>

                    <div class="toggle-item" onclick="toggleAddon('materials', 0.4, this)">
                        <div class="opt-text"><strong>–ó–∞–∫—É–ø–∫–∞ —á–µ—Ä–Ω–æ–≤—ã—Ö</strong><span>–°–º–µ—Å–∏, –∫–ª–µ–∏, –ø—Ä–æ–≤–æ–¥–∞ (–º–∞—Ç–µ—Ä–∏–∞–ª)</span></div>
                        <div class="toggle-switch"></div>
                    </div>

                    <div class="toggle-item" onclick="toggleAddon('sound', 1500, this)">
                        <div class="opt-text"><strong>–®—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è</strong><span>–°—Ç–µ–Ω—ã –∏ –ø–æ—Ç–æ–ª–æ–∫</span></div>
                        <div class="toggle-switch"></div>
                    </div>

                    <div class="nav-footer">
                        <button class="btn btn-back" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
                        <button class="btn btn-primary" onclick="calculateResult()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏—Ç–æ–≥</button>
                    </div>
                </div>

                <!-- RESULT -->
                <div class="step" id="stepResult">
                    <div style="text-align: center; margin-top: 20px;">
                        <h2>–ì–æ—Ç–æ–≤–æ! üéâ</h2>
                        <p class="subtitle">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:</p>
                        
                        <div class="result-box">
                            <div style="font-size: 12px; color: #94a3b8; text-transform: uppercase;">–ë—é–¥–∂–µ—Ç (–†–∞–±–æ—Ç–∞ + –ú–∞—Ç–µ—Ä–∏–∞–ª—ã)</div>
                            <div class="price-final" id="finalPrice">0 ‚ÇΩ</div>
                            <div style="font-size: 13px; color: #ef4444;">* –¶–µ–Ω–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 7 –¥–Ω–µ–π</div>
                        </div>

                        <p class="subtitle" style="margin-bottom: 15px;">–ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é —Å–º–µ—Ç—É PDF?</p>

                        <a href="#" id="waLink" target="_blank" class="messenger-btn bg-wa">
                            <span>WhatsApp</span>
                        </a>
                        <a href="#" id="tgLink" target="_blank" class="messenger-btn bg-tg">
                            <span>Telegram</span>
                        </a>
                        
                        <button class="btn btn-back" onclick="location.reload()" style="margin-top: 10px; width: 100%;">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

<script>
    /* --- 1. –õ–û–ì–ò–ö–ê –ò –¶–ï–ù–´ (Edit here) --- */
    const CONFIG = {
        // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
        type: { new: 1, secondary: 1.3, house: 1.1 },
        level: { base: 12000, standard: 25000, premium: 45000 },
        // –ö–æ–Ω—Ç–∞–∫—Ç—ã
        phone: "79991234567",
        username: "username" 
    };

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ
    let state = {
        step: 1,
        data: {
            type: { val: 'new', factor: 1, name: '–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞' },
            area: 55,
            rooms: { val: '1', name: '1 –∫–æ–º–Ω–∞—Ç–∞' },
            level: { val: 'standard', price: 25000, name: '–ö–æ–º—Ñ–æ—Ä—Ç' },
            addons: [] // { id, price, name, isPercent }
        }
    };

    const totalSteps = 6;

    /* --- 2. –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê --- */

    function updateProgress() {
        const percent = Math.round(((state.step - 1) / (totalSteps - 1)) * 100);
        document.getElementById('progressBar').style.width = percent + '%';
        document.getElementById('percentCounter').innerText = percent + '%';
        document.getElementById('stepCounter').innerText = state.step < 6 ? `–®–∞–≥ ${state.step} –∏–∑ 5` : '–§–∏–Ω–∞–ª';
    }

    function showStep(n) {
        document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
        document.getElementById(n === 6 ? 'stepResult' : 'step' + n).classList.add('active');
        state.step = n;
        updateProgress();
    }

    function nextStep() { if (state.step < totalSteps) showStep(state.step + 1); }
    function prevStep() { if (state.step > 1) showStep(state.step - 1); }

    // –í—ã–±–æ—Ä –æ–ø—Ü–∏–∏ (Type, Rooms, Level)
    function selectOption(category, value, factorOrPrice, el) {
        // –í–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ
        const parent = el.closest('.options-grid');
        parent.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        const name = el.querySelector('.opt-text strong').innerText;
        if (category === 'level') {
            state.data[category] = { val: value, price: factorOrPrice, name };
        } else if (category === 'type') {
            state.data[category] = { val: value, factor: factorOrPrice, name };
        } else {
            state.data[category] = { val: value, name };
        }

        // –ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥
        setTimeout(nextStep, 350);
    }

    // –°–ª–∞–π–¥–µ—Ä
    function updateArea(val) {
        state.data.area = parseInt(val);
        document.getElementById('areaVal').innerText = val;
    }

    // –¢–æ–≥–≥–ª—ã (–î–æ–ø—ã)
    function toggleAddon(id, price, el) {
        el.classList.toggle('active');
        const isActive = el.classList.contains('active');
        const name = el.querySelector('.opt-text strong').innerText;
        
        if (isActive) {
            state.data.addons.push({ id, price, name, isPercent: price < 10 }); 
            // * if price < 10, —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (0.4 = 40%)
        } else {
            state.data.addons = state.data.addons.filter(a => a.id !== id);
        }
    }

    /* --- 3. –†–ê–°–ß–ï–¢ –ò –ò–¢–û–ì --- */
    function formatMoney(num) { return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " "); }

    function calculateResult() {
        showStep(6);
        
        // –ë–∞–∑–∞: –ü–ª–æ—â–∞–¥—å * –¶–µ–Ω–∞–†–µ–º–æ–Ω—Ç–∞ * –°–ª–æ–∂–Ω–æ—Å—Ç—å–¢–∏–ø–∞
        let baseCost = state.data.area * state.data.level.price * state.data.type.factor;
        
        // –î–æ–ø—ã
        let addonsCost = 0;
        let percentAddonsFactor = 0;

        state.data.addons.forEach(addon => {
            if (addon.isPercent) {
                percentAddonsFactor += addon.price; // –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã
            } else {
                addonsCost += addon.price * state.data.area; // —Ü–µ–Ω–∞ –∑–∞ –º–µ—Ç—Ä
            }
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –¥–æ–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª—ã) –∫ –±–∞–∑–µ
        let materialCost = baseCost * percentAddonsFactor;
        
        let total = baseCost + addonsCost + materialCost;
        
        // –î–∏–∞–ø–∞–∑–æ–Ω
        let min = Math.floor(total * 0.95 / 1000) * 1000;
        let max = Math.floor(total * 1.15 / 1000) * 1000;
        
        document.getElementById('finalPrice').innerText = `${formatMoney(min)} - ${formatMoney(max)} ‚ÇΩ`;

        generateLinks(min, max);
    }

    function generateLinks(min, max) {
        const addonsNames = state.data.addons.map(a => a.name).join(', ') || '–ù–µ—Ç';
        const msg = `
üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –†–∞—Å—á–µ—Ç —Å —Å–∞–π—Ç–∞:
üè† –û–±—ä–µ–∫—Ç: ${state.data.type.name}
üìê –ü–ª–æ—â–∞–¥—å: ${state.data.area} –º¬≤
üö™ –ö–æ–º–Ω–∞—Ç: ${state.data.rooms.name}
üíé –†–µ–º–æ–Ω—Ç: ${state.data.level.name}
‚ûï –û–ø—Ü–∏–∏: ${addonsNames}
üí∞ –ò—Ç–æ–≥: ${formatMoney(min)} - ${formatMoney(max)} ‚ÇΩ

–ù—É–∂–Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è.
        `.trim();
        const enc = encodeURIComponent(msg);
        document.getElementById('waLink').href = `https://wa.me/${CONFIG.phone}?text=${enc}`;
        document.getElementById('tgLink').href = `https://t.me/${CONFIG.username}?text=${enc}`;
    }

    /* --- 4. 3D TILT EFFECT (DESKTOP ONLY) --- */
    const wrapper = document.getElementById('tiltWrapper');
    const card = wrapper.querySelector('.glass-card');

    if (window.matchMedia("(hover: hover)").matches) {
        document.addEventListener('mousemove', (e) => {
            const x = (window.innerWidth / 2 - e.pageX) / 30;
            const y = (window.innerHeight / 2 - e.pageY) / 30;
            wrapper.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
        });
    }

    // –°—Ç–∞—Ä—Ç
    updateProgress();
</script>

</body>
</html>
